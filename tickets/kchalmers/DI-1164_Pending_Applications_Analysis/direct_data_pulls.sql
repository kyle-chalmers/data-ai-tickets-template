-- ============================================================================
-- DIRECT DATA PULLS FOR PENDING APPLICATIONS ANALYSIS
-- Raw data extracts from actual database tables
-- ============================================================================

-- 1. Basic Application Data from Originations View
SELECT 
    APPLICATION_ID,
    AMOUNT,
    TIER,
    UTM_SOURCE,
    PORTFOLIONAME,
    LAST_TOUCH_UTM_CHANNEL_GROUPING,
    DATE,
    ORIGINATION_STATUS,
    DATA_SOURCE
FROM BUSINESS_INTELLIGENCE.REPORTING.VW_ORIGINATIONS_AND_PENDING_ORIGINATIONS_OPTIMIZED
WHERE APPLICATION_ID IN ('3012211','3012495','3016579','2963364','3014115','3016235',
                         '3016071','2977446','3011634','3007232','3011932','3016798',
                         '3016931','3000933','3003732','3014711','3017141','3012766',
                         '3017196','3015042','3016106','3012386','3017586','3010286',
                         '3017275','3016050','3017833','3016038','2927052','3013953',
                         '3015476','2955104','2993310','3018044','3011226','3009787',
                         '3012842','3015898','2833697','3018403','3009694','2129780',
                         '3018148','3001929')
    AND DATE = '2025-08-07'
    AND ORIGINATION_STATUS = 'Pending';

-- 2. LOS Portfolios Data
SELECT 
    APPLICATION_ID,
    PORTFOLIO_NAME,
    PORTFOLIO_ID,
    SUB_PORTFOLIO_NAME,
    IS_CURRENT_PORTFOLIO
FROM ANALYTICS.VW_APP_PORTFOLIOS_AND_SUB_PORTFOLIOS
WHERE APPLICATION_ID IN ('3012211','3012495','3016579','2963364','3014115','3016235',
                         '3016071','2977446','3011634','3007232','3011932','3016798',
                         '3016931','3000933','3003732','3014711','3017141','3012766',
                         '3017196','3015042','3016106','3012386','3017586','3010286',
                         '3017275','3016050','3017833','3016038','2927052','3013953',
                         '3015476','2955104','2993310','3018044','3011226','3009787',
                         '3012842','3015898','2833697','3018403','3009694','2129780',
                         '3018148','3001929')
ORDER BY APPLICATION_ID, PORTFOLIO_NAME;

-- 3. Application Status Transition Data
SELECT 
    APPLICATION_ID,
    APPLICATION_STARTED_DATETIME,
    FIRST_UNDERWRITING_DATETIME,
    FIRST_LOAN_DOCS_COMPLETED_DATETIME,
    LAST_LOAN_DOCS_COMPLETED_DATETIME,
    SELECTED_OFFER_AMOUNT,
    SOURCE,
    LAST_STATUS_VALUE,
    LAST_STATUS_BEGIN_DATETIME
FROM ANALYTICS.VW_APPLICATION_STATUS_TRANSITION_WIP
WHERE APPLICATION_ID IN ('3012211','3012495','3016579','2963364','3014115','3016235',
                         '3016071','2977446','3011634','3007232','3011932','3016798',
                         '3016931','3000933','3003732','3014711','3017141','3012766',
                         '3017196','3015042','3016106','3012386','3017586','3010286',
                         '3017275','3016050','3017833','3016038','2927052','3013953',
                         '3015476','2955104','2993310','3018044','3011226','3009787',
                         '3012842','3015898','2833697','3018403','3009694','2129780',
                         '3018148','3001929')
    AND SOURCE = 'LOANPRO';

-- 4. Current Loan Settings and Status
SELECT 
    C.LOAN_ID AS APPLICATION_ID,
    SS.TITLE AS CURRENT_STATUS,
    C.CREATED,
    C.LAST_UPDATE,
    C.LOAN_SUB_STATUS_ID,
    SCE.COMPANY_NAME AS SOURCE_COMPANY
FROM BRIDGE.VW_LOAN_SETTINGS_ENTITY_CURRENT C
INNER JOIN BRIDGE.VW_LOAN_SUB_STATUS_ENTITY_CURRENT SS
    ON SS.ID = C.LOAN_SUB_STATUS_ID
    AND C.SCHEMA_NAME = SS.SCHEMA_NAME
LEFT JOIN BRIDGE.VW_SOURCE_COMPANY_ENTITY_CURRENT SCE
    ON C.SOURCE_COMPANY = SCE.ID
    AND SCE.SCHEMA_NAME = CONFIG.LOS_SCHEMA()
WHERE C.LOAN_ID IN ('3012211','3012495','3016579','2963364','3014115','3016235',
                    '3016071','2977446','3011634','3007232','3011932','3016798',
                    '3016931','3000933','3003732','3014711','3017141','3012766',
                    '3017196','3015042','3016106','3012386','3017586','3010286',
                    '3017275','3016050','3017833','3016038','2927052','3013953',
                    '3015476','2955104','2993310','3018044','3011226','3009787',
                    '3012842','3015898','2833697','3018403','3009694','2129780',
                    '3018148','3001929');

-- 5. Custom Loan Settings (Automation Fields)
SELECT 
    LOAN_ID AS APPLICATION_ID,
    APPLICATION_STARTED_DATE,
    AFFILIATE_STARTED_DATE_TIME,
    UNDERWRITING_TIMER,
    AUTOMATION_BANK_ACCOUNT_CHECK_STATUS,
    AUTOMATION_IDENTITY_CHECK_STATUS,
    AUTOMATION_INCOME_CHECK_STATUS,
    REQUESTED_LOAN_AMOUNT,
    SELECTED_OFFER_AMOUNT,
    TIER,
    UTM_SOURCE,
    PRICING_TIER,
    IS_STACKER,
    PARTNER_PORTFOLIO_NAME
FROM BRIDGE.VW_LOS_CUSTOM_LOAN_SETTINGS_CURRENT
WHERE LOAN_ID IN ('3012211','3012495','3016579','2963364','3014115','3016235',
                  '3016071','2977446','3011634','3007232','3011932','3016798',
                  '3016931','3000933','3003732','3014711','3017141','3012766',
                  '3017196','3015042','3016106','3012386','3017586','3010286',
                  '3017275','3016050','3017833','3016038','2927052','3013953',
                  '3015476','2955104','2993310','3018044','3011226','3009787',
                  '3012842','3015898','2833697','3018403','3009694','2129780',
                  '3018148','3001929');

-- 6. Application Status History (for timeline analysis)
SELECT 
    APPLICATION_ID,
    OLD_STATUS_VALUE,
    NEW_STATUS_VALUE,
    OLD_STATUS_BEGIN_DATETIME,
    NEW_STATUS_BEGIN_DATETIME,
    TIME_SPENT_IN_OLD_STATUS,
    SOURCE
FROM BUSINESS_INTELLIGENCE.ANALYTICS.VW_APPLICATION_STATUS_HISTORY
WHERE APPLICATION_ID IN ('3012211','3012495','3016579','2963364','3014115','3016235',
                         '3016071','2977446','3011634','3007232','3011932','3016798',
                         '3016931','3000933','3003732','3014711','3017141','3012766',
                         '3017196','3015042','3016106','3012386','3017586','3010286',
                         '3017275','3016050','3017833','3016038','2927052','3013953',
                         '3015476','2955104','2993310','3018044','3011226','3009787',
                         '3012842','3015898','2833697','3018403','3009694','2129780',
                         '3018148','3001929')
    AND SOURCE = 'LOANPRO'
ORDER BY APPLICATION_ID, NEW_STATUS_BEGIN_DATETIME;

-- 7. Smart Checklist Status (if available)
SELECT 
    LOAN_ID AS APPLICATION_ID,
    CHECKLIST_ITEM,
    IS_COMPLETE,
    LAST_UPDATED,
    COMPLETION_DATE
FROM BRIDGE.VW_SMART_CHECKLIST_CURRENT
WHERE LOAN_ID IN ('3012211','3012495','3016579','2963364','3014115','3016235',
                  '3016071','2977446','3011634','3007232','3011932','3016798',
                  '3016931','3000933','3003732','3014711','3017141','3012766',
                  '3017196','3015042','3016106','3012386','3017586','3010286',
                  '3017275','3016050','3017833','3016038','2927052','3013953',
                  '3015476','2955104','2993310','3018044','3011226','3009787',
                  '3012842','3015898','2833697','3018403','3009694','2129780',
                  '3018148','3001929')
ORDER BY APPLICATION_ID, CHECKLIST_ITEM;

-- 8. Document Upload Status (if available)
SELECT 
    APPLICATION_ID,
    DOCUMENT_TYPE,
    UPLOAD_DATE,
    STATUS,
    REQUIRED_FLAG
FROM BRIDGE.VW_DOCUMENT_UPLOADS_CURRENT
WHERE APPLICATION_ID IN ('3012211','3012495','3016579','2963364','3014115','3016235',
                         '3016071','2977446','3011634','3007232','3011932','3016798',
                         '3016931','3000933','3003732','3014711','3017141','3012766',
                         '3017196','3015042','3016106','3012386','3017586','3010286',
                         '3017275','3016050','3017833','3016038','2927052','3013953',
                         '3015476','2955104','2993310','3018044','3011226','3009787',
                         '3012842','3015898','2833697','3018403','3009694','2129780',
                         '3018148','3001929')
ORDER BY APPLICATION_ID, DOCUMENT_TYPE;

-- ============================================================================
-- USAGE NOTES:
-- 1. Run each query separately to get raw data from each table
-- 2. Some queries may return no results if the view/table doesn't exist
-- 3. Join these results in Excel/Python for comprehensive analysis
-- 4. Replace APPLICATION_ID list as needed for different cohorts
-- ============================================================================